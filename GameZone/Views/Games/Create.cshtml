@using GameZone.Settings;
@model CreateGameVM;
@{
    ViewData["Title"] = "Add Game";
}
<h5>
    <i class="fa-solid fa-square-plus me-2"></i> Add new Game
</h5>

<form asp-controller="Games" enctype="multipart/form-data">

    <div class="row">
        <div class="col-md-6"> 
            <div class="form-group">
                <label asp-for="Name" class="form-label mt-4"></label>
                <input type="text" asp-for="Name" class="form-control"  placeholder="Enter Name">
                <span asp-validation-for="Name" class="text-danger"></span>
            </div>
            
            <div class="form-group">
                <label asp-for="CategoryId" class="form-label mt-4"></label>
                <select asp-for="CategoryId" asp-items="Model?.Categories" class="form-select" id="exampleSelect1">
                    <option value="" selected disabled>--Select Category</option>
                </select>
                <span asp-validation-for="CategoryId" class="text-danger"></span>
            </div>   
            <div class="form-group">
                <label asp-for="SelectedDevices" class="form-label mt-4"></label>
                <select asp-for="SelectedDevices" asp-items="Model?.Devices" class="form-select" id="exampleSelect1">
                    <option value="" selected disabled>--Select Device</option>
                </select>
                <span asp-validation-for="SelectedDevices" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Description" class="form-label mt-4"></label>
                <textarea type="text" asp-for="Description" class="form-control" placeholder="Enter Description"></textarea>
                <span asp-validation-for="Description" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Cover" class="form-label mt-4"></label>
                <input onchange="uploadImage()"
                    data-rule-extension="@FileSettings.AllowedExtension.Replace(".", string.Empty)"
                       data-msg-extension="Not allowed extension"
                       data-rule-filesize="@FileSettings.MaxFileSizeInBytes"
                       data-msg-filesize="Max Allowed Size is @FileSettings.MaxFileSizeInMB" MB
                       type="file" asp-for="Cover" class="form-control">
                <span asp-validation-for="Cover" class="text-danger"></span>
            </div>
            <button class="btn btn-light text-black mt-4">Create</button>
        </div>
        <div class="col-md-6 d-flex justify-content-center align-items-center">
            <img id="previewImage" class="w-75 h-75" />
        </div>
    
    </div>
</form>
@section Scripts{
  <partial name="_ValidationScriptsPartial.cshtml">
  <script>
      $.validator.addMethod('filesize', function (value, ele, param) {
          return this.optional(ele) || ele.files[0].size <= param
      });

            function uploadImage() {
                var fileInput = document.getElementById("Cover");
                var previewImage = document.getElementById("previewImage");

                var file = fileInput.files[0];
                if (file) {
                    var reader = new FileReader();

                    reader.onload = function (e) {
                        previewImage.src = e.target.result;

                        // الآن يمكنك إرسال الصورة إلى الخادم إذا كنت بحاجة إلى ذلك.
                        // يمكنك استخدام AJAX لإرسال الصورة إلى الخادم بشكل غير مزامن.
                        // على سبيل المثال:
                        // $.ajax({
                        //     url: "/YourPageHandler",
                        //     type: "POST",
                        //     data: { image: e.target.result },
                        //     success: function(response) {
                        //         console.log("Image uploaded successfully");
                        //     },
                        //     error: function(error) {
                        //         console.error("Error uploading image: ", error);
                        //     }
                        // });
                    };

                    reader.readAsDataURL(file);
                }
            }

  </script>


}